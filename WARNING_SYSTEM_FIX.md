# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–∏—Å—Ç–µ–º–∞ –≤—ã–≥–æ–≤–æ—Ä–æ–≤ (–≤–∞—Ä–Ω–æ–≤)

## –ü—Ä–æ–±–ª–µ–º–∞
–°–∏—Å—Ç–µ–º–∞ –≤–∞—Ä–Ω–æ–≤ –±—ã–ª–∞ –†–ê–ó–ë–ò–¢–ê –Ω–∞ 2 —á–∞—Å—Ç–∏:
- **–ö–æ–≥–¥–∞ –∞–¥–º–∏–Ω –≤—ã–¥–∞–µ—Ç –≤–∞—Ä–Ω** (`/warn`) ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `db.warnings`
- **–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** (`/infopol`) ‚Üí —á–∏—Ç–∞–µ—Ç –∏–∑ `db.userViolations`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç, —á—Ç–æ –≤—ã–¥–∞–ª –≤–∞—Ä–Ω, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "–Ω–µ—Ç –≤–∞—Ä–Ω–æ–≤"

## –ü—Ä–∏–º–µ—Ä –±–∞–≥–∏:
```
–ê–¥–º–∏–Ω: /warn @User "—Å–ø–∞–º" ‚Üí ‚úÖ –ì–æ—Ç–æ–≤–æ, —É –Ω–µ–≥–æ 1 –≤–∞—Ä–Ω
–°–∏—Å—Ç–µ–º–∞: –°–æ—Ö—Ä–∞–Ω–∏–ª–∞ –≤ db.warnings

User: /infopol ‚Üí ‚ùå –£ –≤–∞—Å 0 –≤–∞—Ä–Ω–æ–≤
–°–∏—Å—Ç–µ–º–∞: –°–º–æ—Ç—Ä–∏—Ç –≤ db.userViolations (—Ç–∞–º –Ω–∏—á–µ–≥–æ –Ω–µ—Ç!)
```

## –†–µ—à–µ–Ω–∏–µ
**–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - —Ç–µ–ø–µ—Ä—å –í–°–ï –≤–∞—Ä–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º –∫–ª—é—á–µ: `userViolations`

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

#### 1. `/warn.js` ‚úÖ
- **–ë—ã–ª–æ:** `db.get('warnings')` ‚Üí `db.set('warnings', warnings)`
- **–°—Ç–∞–ª–æ:** `db.get('userViolations')` ‚Üí `db.set('userViolations', userViolations)`
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞—Ä–Ω–∞ —Ç–µ–ø–µ—Ä—å:**
  ```javascript
  {
    type: 'warn',      // —Ç–∏–ø –Ω–∞—Ä—É—à–µ–Ω–∏—è
    reason: '—Å–ø–∞–º',    // –ø—Ä–∏—á–∏–Ω–∞
    timestamp: '...',   // –∫–æ–≥–¥–∞ –≤—ã–¥–∞–Ω
    adminId: '...'     // –∫—Ç–æ –≤—ã–¥–∞–ª
  }
  ```
- **–£–ª—É—á—à–µ–Ω–æ:** DM —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "X / 3" –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —Å–Ω—è—Ç–∏–∏ –≤ –º—É—Ç–µ

#### 2. `/unwarn.js` ‚úÖ
- **–ë—ã–ª–æ:** `db.get('warnings')`
- **–°—Ç–∞–ª–æ:** `db.get('userViolations')`
- –¢–µ–ø–µ—Ä—å —É–¥–∞–ª—è–µ—Ç –≤–∞—Ä–Ω—ã –∏–∑ –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –º–µ—Å—Ç–∞

#### 3. `/audit.js` ‚úÖ
- **–ë—ã–ª–æ:** `db.get('warnings')`
- **–°—Ç–∞–ª–æ:** `db.get('userViolations')`
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞:** `if (v.type !== 'warn')` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞—Ä–Ω—ã, –Ω–µ –¥—Ä—É–≥–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è

#### 4. `/infopol.js` ‚úÖ
- **–£–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `userViolations`** - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
node -c bot/commands/warn.js      ‚úÖ OK
node -c bot/commands/unwarn.js    ‚úÖ OK
node -c bot/commands/audit.js     ‚úÖ OK
node -c bot/commands/infopol.js   ‚úÖ OK
```

## –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –≤–∞—Ä–Ω—ã –∏–∑ `db.warnings` –≤ `db.userViolations`:

```javascript
// –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –æ–¥–∏–Ω —Ä–∞–∑:
const db = require('./bot/libs/db');
await db.ensureReady();

const oldWarnings = db.get('warnings') || {};
const userViolations = db.get('userViolations') || {};

for (const [userId, warns] of Object.entries(oldWarnings)) {
  if (!userViolations[userId]) userViolations[userId] = [];
  warns.forEach(w => {
    userViolations[userId].push({
      type: 'warn',
      reason: w.reason,
      timestamp: w.timestamp,
      adminId: w.adminId
    });
  });
}

await db.set('userViolations', userViolations);
console.log('‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–í—ã–¥–∞—Ç—å –≤–∞—Ä–Ω:**
   ```
   /warn @TestUser "—Ç–µ—Å—Ç" 
   ```
   ‚úÖ –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "–í—Å–µ–≥–æ –≤–∞—Ä–Ω–æ–≤: 1"

2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∞–º:**
   ```
   /infopol
   ```
   ‚úÖ –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "‚ö†Ô∏è –ê–∫—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–Ω—ã (30 –¥–Ω–µ–π): 1 / 3"

3. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
   ```
   /audit warns
   ```
   ‚úÖ –î–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤—ã–¥–∞–Ω–Ω—ã–π –≤–∞—Ä–Ω

4. **–£–¥–∞–ª–∏—Ç—å –≤–∞—Ä–Ω:**
   ```
   /unwarn @TestUser 1
   ```
   ‚úÖ –í–∞—Ä–Ω —É–¥–∞–ª–µ–Ω –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞

## –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π –∫–ª—é—á `userViolations`
